To make a distribution make sure you do:


Before creating the distribution
================================

- make sure your CVS tree is up to date and that there are no uncommited files
- change the version number in configure.in, in include/ambulant/version.h
  and src/player_macos/Info.plist.
- check the following files for being up-to-date:
  - README
  - INSTALL
  - Documentation/misc/README-ZAURUS
  - Documentation/misc/README-Distribution (this file)
  - third_party_packages/readme.txt
- You must update NEWS, give a high-level overview of what has changed.
- You must update Changelog. There is a tool cvs2cl that does this
  more-or-less automatically, something like the following command line should
  do the trick:
  
  % cvs log -b -d '>'2004-07-01 | cvs2cl.pl --stdout --stdin
- Update the API documentation in Documentation/API by running doxygen
- Update the translations:
  - in po, run "make ambulant.pot-update"
  - Edit the various ".po" files. Especially check empty strings
    and fuzzy matches.

To create the linux source distribution
=======================================

- Use make distcheck
- If make distcheck complains about not being able to find expat, 
  you have to set the path to the expat library via the environment variable:
 

	DISTCHECK_CONFIGURE_FLAGS="--with-expat=`pwd`/third_party_packages/expat-unix --with-ffmpeg=`pwd`/third_party_packages/ffmpeg-0.4.8" make distcheck

Creating the third_party_packages-WIN32 distribution
====================================================

To be supplied.

Binary distribution contents
============================

All binary distribution should contain the following files:
- README
- the player binary, preferable staticly linked
- COPYING (The GNU License)
- DemoPresentation from Extras

Windows desktop also needs:
- Welcome from Extras
- AmbulantPlayerHelp.chm from Documentation/user-htmlhelp

Windows CE needs:
- Welcome from Extras

Zaurus needs:
- Welcome from Extras
- README-ZAURUS from Documentation/misc
- Documentation/user

Creating the MacOSX installer
=============================

- Build *and install* the player.
- Create a folder called something like "Ambulant Player 1.2", 
  and copy the items mentioned above into it.
- Use Applications->Utilities->Disk Utilities to create a .dmg
  disk image from this folder (read only, compressed). Make sure the
  version number is part of the disk image name.

Creating the Windows desktop installer
======================================

Build the player.

Open src/AmbulantWin32Installer/AmbulantWiseInstaller.wse with Wise.
Make sure the files mentioned above are included. If you need to add more
files: Wise will use absolute paths by default (for the source files), you
want to turn these into relative paths.

The installer will be deposited in bin/win32. You need to change the filename
to include the version number.

TBD: are there version numbers to be fixed?

TBD: Wise version?

Creating the Windows CE installer
=================================

Build the player.

Open src/AmbulantWin32Installer/AmbulantWinCEWiseInstaller.wse with Wise.
The procedure is pretty similar as for the desktop windows player, the
installer ends up in bin/wince.

Creating the Zaurus installer
=============================

To be supplied.

Creating the Linux installer
============================

For this release we will probably not do Linux binary installers,
but as we have done one before we should write down the procedure here.


Testing the distributions
=========================

Here are some random remarks about testing the distributions.

- The Mac player must definitely be tested on a virgin machine,
  to ensure there are no dependencies on dynamic libraries in /usr/local
  or something like that.
  
- On all platforms, test either on a virgin machine or at least
  clear out preferences before testing (unix: $HOME/.ambulant;
  mac: ~/Library/Preferences/org.ambulantplayer.ambulantplayer.plist;
  windows: HKEY_CURRENT_USER\Software\Ambulant\AmbulantPlayer in the registry).
  
- On windows, test on at least Win98, Win2K and WinXP.
  
- Make sure Welcome plays at first run. Check that the preferences have
  sensible defaults (log level: trace, parser: expat, log window: closed).

- Then play DemoPresentation/NYC-SMIL2.smil.
  Then play the website documents. Use the Xerces parser. Open the log window,
  select "debug" output, and make sure that there aren't any accidental
  AM_DBG's left on.
  
- For each platform, try and get someone knowledgable with the platform but
  not the Ambulant Player to build the distribution.
  
- On the platforms that support it (Linux, Mac) test localisation. We
  should have at least English and Dutch working.
  
- On each platform, check that the version numbers are correct in things
  like the about dialog, Get Info (Properties) in the Finder (Explorer), etc.
  
Uploading the distributions
===========================

To be supplied.
- Don't forget to use different filenames (so SF stats work) for each release.

Updating the website
====================

To be supplied. Here are some random thoughts:
- The design and API docs need to be uploaded
- The SMIL documents need to be uploaded (if changed)

Advertising the distributions
=============================

To be supplied. Some ideas:
- ambulant-announce
- ambulant-users
- www-smil
- W3C
-   http://guide.apple.com/usindex.lasso
-   http://www.apple.com/downloads/macosx/submit
-   http://www.versiontracker.com/ (userid Jack.Jansen@oratrix.com)
-   http://www.macshareware.net (userid jackjansen)
-   archivist@info-mac.org
-   adcnews@apple.com?
-   news@macnn.com
-   http://www.macupdate.com
