# this command was used to link an almost self-contained ambulant plugin
# befor executing, following hand-made changes were done:
# configured ambulant:
#./configure --prefix=$HOME CXXFLAGS="-fPIC -I$HOME/include -I$HOME/Work/Ambulant/ambulant/third_party_packages/xulrunner-sdk/include/plugin/ -O0  -g" LDFLAGS="-L$HOME/lib -L$HOME/Work/Ambulant/ambulant/third_party_packages/xulrunner-sdk/lib/" CFLAGS="-I$HOME/include -I$HOME/Work/Ambulant/ambulant/third_party_packages/xulrunner-sdk/include/plugin/ -O0 -g" CPPFLAGS=-I$HOME/include --without-xerces --without-xerces-plugin --with-npambulant --without-plugins --enable-static --disable-dynamic
# make;make install
# all third-party libraries installed in $HOME/lib, and the .so versions removed
# AmbulantPlayer_gtk was build, and installed in $HOME
# .so version were removed and symbolic links were made in $HOME/lib:
# ln -s libambulant_ffmeg.a libambulant_ffmpeg, etc.
(cd $HOME/lib;rm -f *.la *.so*;for file in `ls *.a`; do base=`basename $file .a`;rm $base;ln -s $file $base;done)
# remaining dependencies should be OK: libbz2, zlib, libSDL, stdlib, clib, libdl, libgtk, libgdk, libpango, libXML2
/bin/sh ../../libtool --mode=link g++ -DWITH_GTK -DMOZ_X11 *.o -g -O2 -pthread  -L$HOME/lib -o libnpambulant.la -rpath $HOME/lib -module ../../libltdl/libltdlc.la ../player_gtk/gtk_mainloop.o ../player_gtk/unix_preferences.o -lambulant_gtk -lambulant -lambulant_live -lBasicUsageEnvironment -lgroupsock -lliveMedia -lUsageEnvironment -lambulant_sdl -pthread -lgtk-x11-2.0 -lgdk-x11-2.0 -latk-1.0 -lgio-2.0 -lpangoft2-1.0 -lgdk_pixbuf-2.0 -lpangocairo-1.0 -lcairo -lpango-1.0 -lfreetype -lfontconfig -lgobject-2.0 -lgmodule-2.0 -lgthread-2.0 -lrt -lglib-2.0   -lambulant_ffmpeg ../../third_party_packages/ffmpeg/libavformat/libavformat.a ../../third_party_packages/ffmpeg/libavcodec/libavcodec.a ../../third_party_packages/ffmpeg/libavutil/libavutil.a -lz -lbz2 -lm $HOME/lib/libfaad.a -ldl -lSDL
cp .libs/libnpambulant.so.0.0.0 $HOME/.mozilla/plugins/npambulant.so
